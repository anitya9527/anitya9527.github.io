<div class="app-refresh" id="app-refresh">
    <div class="app-refresh-wrap">
        <label>âœ¨ ç¶²ç«™å·²æ›´æ–°æœ€æ–°ç‰ˆæœ¬ ğŸ‘‰</label>
        <a href="javascript:void(0)" onclick="location.reload()">é»æ“Šåˆ·æ–°</a>
    </div>
</div>
<script>
    if ('serviceWorker' in navigator) {
        if (navigator.serviceWorker.controller) {
            navigator.serviceWorker.addEventListener('controllerchange', function() {
                showNotification()
            })
        }

        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/sw.js')
        })

        // ã€Œå¼¹å‡ºæ·»åŠ åˆ°ä¸»å±å¯¹è¯æ¡†ã€äº‹ä»¶
        window.addEventListener('beforeinstallprompt', event => {
            // è¿™ä¸ª `event.userChoice` æ˜¯ä¸€ä¸ª Promise ï¼Œåœ¨ç”¨æˆ·é€‰æ‹©å resolve
            event.userChoice.then(result => {
                console.log(result.outcome)
                    // 'accepted': æ·»åŠ åˆ°ä¸»å±
                    // 'dismissed': ç”¨æˆ·ä¸æƒ³ç†ä½ å¹¶å‘ä½ æ‰”äº†ä¸ªå–æ¶ˆ
            })
        })

    }

    function showNotification() {
        if (GLOBAL_CONFIG.Snackbar) {
            var snackbarBg =
                document.documentElement.getAttribute('data-theme') === 'light' ?
                GLOBAL_CONFIG.Snackbar.bgLight :
                GLOBAL_CONFIG.Snackbar.bgDark
            var snackbarPos = GLOBAL_CONFIG.Snackbar.position
            Snackbar.show({
                text: 'å·²æ›´æ–°æœ€æ–°ç‰ˆæœ¬',
                backgroundColor: snackbarBg,
                duration: 50000,
                pos: snackbarPos,
                actionText: 'é»æ“Šåˆ·æ–°',
                actionTextColor: '#fff',
                onActionClick: function(e) {
                    location.reload()
                },
            })
        } else {
            var showBg =
                document.documentElement.getAttribute('data-theme') === 'light' ?
                '#49b1f5' :
                '#1f1f1f'
            var cssText = `top: 0; background: ${showBg};`
            document.getElementById('app-refresh').style.cssText = cssText
        }
    }
</script>